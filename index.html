<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'>

  <title>Barista</title>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <script src="http://shjs.sourceforge.net/sh_main.min.js"></script>
  <script src="http://shjs.sourceforge.net/lang/sh_javascript.min.js"></script>

  <link href='http://fonts.googleapis.com/css?family=Swanky+and+Moo+Moo' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" title="Default" href="twilight.css" type='text/css'>
  <link rel="stylesheet" title="Default" href="screen.css" type='text/css'>


  <script>
  $(function(){
    sh_highlightDocument();

    $('pre span.sh_string').each(function(id,el){
      $(el).html(
        $(el).text()
          .replace(/(:\w+)/g,'<span class="barista_key">$1</span>')
          .replace(/(\*\w+)/g,'<span class="barista_glob">$1</span>')
      )
    })

    $('#convenience_methods span.sh_function').each(function(id,el){
      var t = $(el).text()
      if ( t == 'get' ||  t == 'put' || t == 'post' || t == 'del' ) $(el).addClass('highlight')
    })

    $('#variables span.barista_key').addClass('highlight')
    $('#globs span.barista_glob').addClass('highlight')

    $('#resources span.sh_function').each(function(id,el){
      if ( $(el).text() == 'resource' ) $(el).addClass('highlight')
    })

    $('#conditions span.sh_function').each(function(id,el){
      if ( $(el).text() == 'where' ) $(el).addClass('highlight')
    })

    $('#generation span.sh_function, #generation span.sh_keyword').each(function(id,el){
      if ( $(el).text() == 'url' || $(el).text() == 'true' ) $(el).addClass('highlight')
    })

    $('#resolution span.sh_function').each(function(id,el){
      if ( $(el).text() == 'first' || $(el).text() == 'all' ) $(el).addClass('highlight')
    })

  })


  </script>
</head>

<body>
  <a href="https://github.com/kieran/barista"><img style="position: fixed; top: 0; right: 0; border: 0;" src="https://a248.e.akamai.net/assets.github.com/img/abad93f42020b733148435e2cd92ce15c542d320/687474703a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677265656e5f3030373230302e706e67" alt="Fork me on GitHub" /></a>


  <img id='title' src="barista.png" />





  <section>
    <header>
      <h2>The Skinny</h2>
    </header>
    <div class='code'>
<pre class="sh_javascript">
// define a route
router.get( '/:beverage/near/:location(.:format)' )
      .to( 'beverage.byLocation' )

// convert a URL to a params object
router.first( '/coffee/near/90210', 'GET' )

/* returns:
{
  controller: 'beverage',
  action: 'byLocation',
  beverage: 'coffee',
  location: 90210
}
*/

// generate a URL from a params object
router.url({
  controller: 'beverage',
  action: 'byLocation',
  beverage: 'coffee',
  location: 90210,
  format: 'json'
})

// => '/coffee/near/90210.json'
</pre>
    </div>
  </section>


  <h1>Installation</h1>

  <section id="installation">
    <header>
      <h2>Install via npm</h2>
    </header>
    <div class='code'>
<pre>
npm install barista
</pre>
    </div>
  </section>

  <section>
    <header>
      <h2>Use it in your app</h2>
    </header>
    <div class='code'>
<pre class="sh_javascript">
var Router = require('barista').Router
  , router = new Router
</pre>
    </div>
  </section>


  <h1>Defining routes</h1>

  <section>
    <header>
      <h2>A simple example</h2>
    </header>
    <div class='code'>
<pre class="sh_javascript">
// a GET request to '/products'
router.match( '/products', 'GET' )
      .to( 'products.index' )

/* returns:
  {
    controller: 'products',
    action: 'index'
  }
*/
</pre>
    </div>
  </section>

  <section id='variables'>
    <header>
      <h2>Rails-esque variable names</h2>
    </header>
    <div class='code'>
<pre class="sh_javascript">
router.match( '/products/:id', 'GET' )
      .to( 'products.show' )

router.match( '/profiles/:username', 'GET' )
      .to( 'users.show' )

// things enclosed in parens are optional
router.match( '/products/:id(.:format)', 'GET' )
      .to( 'products.show' )
</pre>
    </div>
  </section>


  <section id='convenience_methods'>
    <header>
      <h2>Convenience methods</h2>
    </header>
    <div class='code'>
<pre class="sh_javascript">
router.get( '/products/:id(.:format)' )
      .to( 'products.show' )

router.put( '/products/:id(.:format)' )
      .to( 'products.update' )

router.post( '/products' )
      .to( 'products.create' )

router.del( '/products' )
      .to( 'products.destroy' )
</pre>
    </div>
  </section>


  <section id='globs'>
    <header>
      <h2>Route globbing</h2>
    </header>
    <div class='code'>
<pre class="sh_javascript">
router.get('/timezones/*tzname')
      .to( 'timezones.select' )

router.first( '/timezones/America/Toronto', 'GET' )

/* returns:
{
  controller: 'timezones',
  action: 'select',
  tzname: 'America/Toronto'
}
*/
</pre>
<br/>
<pre class="sh_javascript">
// a "catch-all" route:
router.match( '/*path(.:format)' )
      .to( 'errors.notFound' )


router.first( '/somewhere/that/four-oh-fours.json', 'GET' )

/* returns:
{
  controller: 'errors',
  action: 'notFound',
  path: 'somewhere/that/four-oh-fours',
  format: 'json'
}
*/
</pre>
    </div>
  </section>



  <section id='resources'>
    <header>
      <h2>REST resources</h2>
    </header>
    <div class='code'>
<pre class="sh_javascript">
router.resource( 'products' )

// is equivalent to:

router.get( '/products(.:format)' )
      .to( 'products.index' )

router.get( '/products/add(.:format)' )
      .to( 'products.add' )

router.get( '/products/:id(.:format)' )
      .to('products.show' )

router.get('/products/:id/edit(.:format)' )
      .to( 'products.edit' )

router.post('/products(.:format)' )
      .to( 'products.create' )

router.put('/products/:id(.:format)' )
      .to( 'products.update' )

router.del('/products/:id(.:format)' )
      .to( 'products.destroy' )
</pre>
    </div>
  </section>


  <section id='conditions'>
    <header>
      <h2>Match conditions</h2>
    </header>
    <div class='code'>
<pre class="sh_javascript">
router.get( '/:beverage/near/:zipcode' )
      .to( 'beverage.byZipCode' )
      .where({
        // an array of options
        beverage: [ 'coffee', 'tea', 'beer', 'warm_sake' ],
        // a regex pattern
        zipcode: /^\d{5}(-\d{4})?$/
      })
</pre>
<br/>
<header>
  <h2>Mixing conditions</h2>
</header>
<pre class="sh_javascript">
router.get( '/:beverage/near/:location' )
      .to( 'beverage.byLocation' )
      .where({
        location: [
          // could be a zip code
          /^\d{5}(-\d{4})?$/,
          // OR a postal code
          /^[A-Z]{1}\d{1}[A-Z]{1} *\d{1}[A-Z]{1}\d{1}$/,
          // OR the word 'me'
          'me'
        ]
      })
</pre>
    </div>
  </section>



  <h1>URL generation</h1>



  <section id='generation'>
    <header>
      <h2>Turn a params object into a URL</h2>
    </header>
    <div class='code'>
<pre class="sh_javascript">
// assuming:
router.resource( 'products' )

// then
router.url( {
  controller: 'products',
  action: 'show',
  id: 5
} )

// => '/products/5'
</pre>
<br/>
<pre class="sh_javascript">
router.url( {
  controller: 'products',
  action: 'show',
  id: 5,
  format: 'json'
} )

// => '/products/5.json'
</pre>
<br/>
<header>
  <h2>Extra params</h2>
</header>
<pre class="sh_javascript">
// you can optionally include extra params as a query string
router.url({
  controller: 'products',
  action: 'show',
  id: 5,
  format: 'json',
  love: 'cheese'
}, true )
//=> '/products/5.json?love=cheese'
</pre>
    </div>
  </section>


  <h1>Resolution &amp; dispatching</h1>
  <section id='resolution'>
    <header>
      <h2>router.first</h2>
    </header>
    <div class='code'>
<pre class="sh_javascript">
// get the first route that matches

var params = router.first( '/products/15', 'GET' )

// returns a params object, or false if nothing matches
</pre>
<br/>
<pre class="sh_javascript">
// go all callback on this shit

router.first( '/products/15', 'GET', function(params){
  // passes a params object in
  // this has not been well thought out.
})
</pre>
<br/>
<header>
  <h2>router.all</h2>
</header>
<pre class="sh_javascript">
// if you want all matching routes...

var params_array = router.all( '/products/15', 'GET' )

// => [ params, params, params... ]
</pre>
    </div>
  </section>


</body>
</html>
